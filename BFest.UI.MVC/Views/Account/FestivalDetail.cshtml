@using BFest.Model
@model Festival
@{
    ViewBag.Title = "Information";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Information</h2>


<!-- Blog Area Start -->
<section id="winterfest" class="confer-blog-details-area section-padding-100-0">
    <div class="container">
        <div class="row justify-content-center">
            <!-- Single Post Details Area -->
            <div class="col-12 col-lg-8 col-xl-9">
                <div class="pr-lg-4 mb-100">
                    <!-- Post Content -->
                    <div class="post-details-content">

                        <!-- Post Thumbnail -->
                        <div class="post-blog-thumbnail mb-30">

                            <img src="~/Assets/img/bg-img/whitefest.jpg" />
                        </div>

                        <!-- Post Title -->
                        <h4 class="post-title">@Model.Name</h4>@{User currentUser = Session["kullanici"] as User;} @{bool haveTicket = false;}@foreach (Ticket item in Model.Tickets)
                        {
                            if (item.UserID == currentUser.ID)
                            {
                                haveTicket = true;
                            }
                        } @if (currentUser != null && !haveTicket)
                        {
                            <a href="@Url.Action("AddTicket", "Account", new { festID=Model.ID, userID = currentUser.ID })" class="btn confer-btn">Katıl<i class="zmdi zmdi-long-arrow-right"></i></a><br />
                        }

                        <!-- Post Meta -->
                        <div class="post-meta">
                            <a class="post-date">@Model.StartDate.ToShortDateString() - @Model.EndDate.ToShortDateString()</a>

                        </div>

                        <p>
                            @Model.Description
                        </p>
                        <br />
                        <div id="comment">
                            @Html.Action("Comment", "Account", new { festivalID = Model.ID })
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@*@if (Session["kullanici"] != null)
    {
        <div class="form-group">
            <textarea id="commentmessage" class="form-control mb-10" rows="5" name="message" placeholder="Message" onfocus="this.placeholder" onblur="this.placeholder='Yorum Yapınız'" required=""></textarea>
        </div>
        <input type="button" onclick="PostComment2()" class="btn btn-warning" value="Post Comment" />
    }*@

@section script{
    <script>
        function PostComment2() {
            var comment = $("#commentmessage").val();
            var festivalID = $("#FestID").val();

            $.ajax({
                type: "GET",
                url: '@Url.Action("PostComment","Account")',
                data: { comment: comment, festivalID: festivalID },
                success: function (data) {
                    $("#comment").html(data);
                }
            });
        }
    </script>
}
